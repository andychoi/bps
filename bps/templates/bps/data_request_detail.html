{% extends "bps/base.html" %}
{% load crispy_forms_tags %}
{% block content %}
<div class="container my-4">
  <h1>Data Request {{ dr.id }}</h1>
  <form method="post" class="mb-4">{% csrf_token %}
    {{ form|crispy }}
    <button type="submit" class="btn btn-primary">Update</button>
    <a href="{% url 'bps:data_request_list' %}" class="btn btn-link">Back to list</a>
  </form>

  <h2>Facts</h2>
  <table class="table table-striped">
    <thead>
      <tr><th>Period</th><th>Key Figure</th><th>Value</th><th>UoM</th><th>Ref Value</th><th>Ref UoM</th></tr>
    </thead>
    <tbody>
      {% for f in facts %}
        <tr>
          <td>{{ f.period.code }}</td>
          <td>{{ f.key_figure.code }}</td>
          <td>{{ f.value }}</td>
          <td>{{ f.uom.code|default:"–" }}</td>
          <td>{{ f.ref_value }}</td>
          <td>{{ f.ref_uom.code|default:"–" }}</td>
        </tr>
      {% empty %}
        <tr><td colspan="6">No facts recorded yet.</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <a href="{% url 'bps:fact_list' dr.pk %}" class="btn btn-success">Add/Edit Facts</a>
</div>
{% endblock %}